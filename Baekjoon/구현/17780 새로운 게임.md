
# ğŸ“š ìƒˆë¡œìš´ ê²Œì„

## ğŸ“Œ [ë¬¸ì œë§í¬](https://www.acmicpc.net/problem/17780)

### ë¬¸ì œ ìš”ì•½

- ì²´ìŠ¤íŒ ìœ„ì— ë§ Kê°œë¥¼ ë†“ëŠ”ë‹¤. (ë§ì€ 1ë²ˆë¶€í„° Kë²ˆê¹Œì§€ ë²ˆí˜¸ê°€ ë§¤ê²¨ì € ìˆë‹¤.)
- 1ë²ˆë¶€í„° Kë²ˆê¹Œì§€ ë²ˆí˜¸ê°€ ë§¤ê²¨ì ¸ ìˆê³ , ì´ë™ ë°©í–¥ë„ ë¯¸ë¦¬ ì •í•´ì ¸ ìˆë‹¤.
- ì´ë™í•˜ë ¤ëŠ” ì¹¸ì´ í°ìƒ‰ => ê¸°ì¡´ ë§ë“¤ ìœ„ì— ìŒ“ê¸°
- ì´ë™í•˜ë ¤ëŠ” ì¹¸ì´ ë¹¨ê°„ìƒ‰ => ê¸°ì¡´ ë§ë“¤ ìœ„ì— ë’¤ì§‘ì–´ì„œ ìŒ“ê¸°
- ì´ë™í•˜ë ¤ëŠ” ì¹¸ì´ íŒŒë€ìƒ‰ => ì´ë™ë°©í–¥ ë°˜ëŒ€ë¡œ ì„¤ì •í•˜ê³  1ì¹¸ì´ë™
- ì´ë™í•˜ë ¤ëŠ” ì¹¸ì´ ë²”ìœ„ ë°– => íŒŒë€ìƒ‰ê³¼ ë™ì¼
- ë§ì´ 4ê°œ ì´ìƒ ìŒ“ì´ëŠ” ìˆœê°„ ê²Œì„ì´ ì¢…ë£Œ 

### ë¬¸ì œ í’€ì´

- ì²´ìŠ¤ ì¥ê¸°ë§ì„ ë²ˆí˜¸ ìˆœì„œëŒ€ë¡œ (r,c,ë°©í–¥)ìœ¼ë¡œ ì €ì¥í•˜ëŠ” ë¦¬ìŠ¤íŠ¸(chess) ìƒì„±
- íŠ¹ì • ì¢Œí‘œë³„ë¡œ ìŒ“ì¸ ì²´ìŠ¤ë§ì„ í™•ì¸í•˜ê¸° ìœ„í•œ 2ì°¨ì› ë¦¬ìŠ¤íŠ¸(chess_map) ìƒì„±
- ì›€ì§ì´ë ¤ëŠ” ì¹¸ì´ íŒŒë€ìƒ‰ì¸ ê²½ìš°ë¥¼ ë¨¼ì € í™•ì¸í•œë‹¤. (íŒŒë€ìƒ‰ì¸ ê²½ìš° ë°©í–¥ì „í™˜ ë° ì´ë™ì„ í•œë²ˆ ë” í•´ì•¼í•˜ê¸° ë•Œë¬¸)
- í°ìƒ‰ë³´ë‹¤ ë¹¨ê°„ìƒ‰ì¸ì§€ ë¨¼ì € í™•ì¸.(ë¹¨ê°„ìƒ‰ì´ë©´ ê±°ê¾¸ë¡œ ë„£ì–´ì¤˜ì•¼ í•¨)
```
import sys

input = sys.stdin.readline
dx = [0,0,-1,1]
dy = [1,-1,0,0]

def move(chess_num):
    x, y, z = chess[chess_num]
    if chess_num != chess_map[x][y][0]: # ê°€ì¥ ì•„ë˜ì— ìˆëŠ” ë§ë§Œ ì´ë™í•  ìˆ˜ ìˆë‹¤.
        return 0
    
    nx = x + dx[z]
    ny = y + dy[z]
    
    # íŒŒë€ìƒ‰
    if not 0 <= nx < n or not 0 <= ny < n or a[nx][ny] == 2:
        if 0<= z <= 1:
            nz = (z+1) % 2
        else:
            nz = (z-1) % 2 + 2
        chess[chess_num][2] = nz
        nx = x + dx[nz]
        ny = y + dy[nz]
        if not 0<= nx < n or not 0<= ny < n or a[nx][ny] == 2: # ë°©í–¥ì„ ë°”ê¿”ë„ ì´ë™í•˜ë ¤ëŠ” ì¹¸ì´ íŒŒë€ìƒ‰
            return 0
    
    chess_set = []
    chess_set.extend(chess_map[x][y])
    chess_map[x][y] = []
    
    # ë¹¨ê°„ìƒ‰ì¸ ê²½ìš°
    if a[nx][ny] == 1:
        chess_set = chess_set[::-1]
    
    for i in chess_set:
        chess_map[nx][ny].append(i)
        chess[i][:2] = [nx,ny]

    if len(chess_map[nx][ny]) >= 4:
        return 1
    return 0

n, k = map(int,input().split())
a = [ list(map(int,input().split())) for _ in range(n) ] # 0: í°ìƒ‰, 1: ë¹¨ê°„ìƒ‰, 2: íŒŒë€ìƒ‰
chess_map = [ [[] for _ in range(n) ] for _ in range(n) ]
chess = [ 0 for _ in range(k)]

for i in range(k):
    x, y, z = map(int,input().split())
    chess_map[x-1][y-1].append(i)
    chess[i] = [x-1,y-1,z-1]

cnt = 1
while cnt <= 1000:
    for i in range(k):
        flag = move(i)
        if flag:
            print(cnt)
            break
            #sys.exit()
    if flag: break
    cnt += 1
else:
    print(-1)
```
